<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Daily Study</title><meta name="author" content="C0KE"><meta name="copyright" content="C0KE"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C0KE&#39;s Study Diary">
<meta property="og:type" content="website">
<meta property="og:title" content="Daily Study">
<meta property="og:url" content="http://example.com/page/18/index.html">
<meta property="og:site_name" content="Daily Study">
<meta property="og:description" content="C0KE&#39;s Study Diary">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/73c31ad1881611ebb6edd017c2d2eca2.jpg">
<meta property="article:author" content="C0KE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/73c31ad1881611ebb6edd017c2d2eca2.jpg"><link rel="shortcut icon" href="/img/fa.jpg"><link rel="canonical" href="http://example.com/page/18/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Daily Study',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-07-10 17:26:03'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/73c31ad1881611ebb6edd017c2d2eca2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">370</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">53</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/%E9%B2%B8%E8%90%BD.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Daily Study"><span class="site-name">Daily Study</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Daily Study</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/C0KE" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_62675330?spm=1000.2115.3001.5343" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:2269279877@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2024/07/10/%E8%93%9D%E5%B8%BD%E6%9D%AF2023%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/" title="蓝帽杯2023初赛复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="蓝帽杯2023初赛复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/%E8%93%9D%E5%B8%BD%E6%9D%AF2023%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/" title="蓝帽杯2023初赛复现">蓝帽杯2023初赛复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.608Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">蓝帽杯2023初赛复现takeway虽然这个题没有给libc，但是我们通过远程发现，该题是存在tcache的，肯定是2.26版本以上的，再搜索一下报错，就发现应该是2.27版本的，再简单逆向一下，发现存UAF漏洞
12345678910111213141516171819unsigned __int64 delete()&#123;  unsigned int v1; // [rsp+4h] [rbp-Ch] BYREF  unsigned __int64 v2; // [rsp+8h] [rbp-8h]  v2 = __readfsqword(0x28u);  v1 = 0;  printf(&quot;Please input your order index: &quot;);  __isoc99_scanf(&quot;%d&quot;, &amp;v1);  if ( v1 &gt;= _5__ || (v1 &amp; 0x80000000) != 0 )  &#123;    puts(&quot;Invalid order!&quot;);    exit(1);  & ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/07/10/%E7%A5%A5%E4%BA%91%E6%9D%AF2022-protocol%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/" title="祥云杯2022-protocol赛后复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="祥云杯2022-protocol赛后复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/%E7%A5%A5%E4%BA%91%E6%9D%AF2022-protocol%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/" title="祥云杯2022-protocol赛后复现">祥云杯2022-protocol赛后复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.607Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">祥云杯2022-protocol赛后复现前言离离原上谱的一道题，开始完全没有任何思路，又是protocol协议，又是静态编译去除符号表的，头都大了，没分析出来。还是赛后看着wp复现的。确实是自己菜狗了
但确实也提醒我去多了解了解网络方面的知识了，pwn终究还是个大杂烩，只会一些二进制漏洞的利用还是不够的，还得和其他方向结合一下。
知识点protocol协议其实就是一个文件传输协议，在你要传输的信息前面加点东西，然后再传输过去，那边再根据协议解包就行了，网上都有现成的资料可以看看
protocol协议的提取在做题的时候我们需要知道protocol协议的一个.proto文件，但是要是让我们去一点点看结构体什么的来提取会很麻烦，还好github上有现成的提取项目可以直接用
https://github.com/marin-m/pbtk
记得安装的时候一定要用python3和pip3，否则会有不知名的错误，一直修不好，血泪教训，如果你python2能用的话，那就没事

用下面的命令来提取文件

1./extractors/from_binary.py  protocol ./ 

就能得到一个 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/07/10/%E7%A5%A5%E4%BA%91%E6%9D%AF2022-unexploitable%20-%20wp/" title="祥云杯2022-unexploitable - wp"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="祥云杯2022-unexploitable - wp"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/%E7%A5%A5%E4%BA%91%E6%9D%AF2022-unexploitable%20-%20wp/" title="祥云杯2022-unexploitable - wp">祥云杯2022-unexploitable - wp</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.607Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">祥云杯2022-unexploitable - wp题目分析分析一下文件，发现只有一个read函数来读取数据，但是给的空间非常大，基本上是随便溢出了。但是还是出了点小问题，刚好这是我第一道爆破的题，记录一下，以后要是忘了还可以回来看看
exp看栈上返回地址的后面第二位是libc_start_main一定偏移的地址，于是我们可以通过部分覆盖法来将该地址覆盖为one_gaget的地址，看师傅们的wp

有用vsyacall来使返回地址滑到libc那里去的
也有通过返回到push ebp之后的地址使返回地址的上一位被弹出的
好像还能用ret2_dl_runtime来做（还没有自己试过）

前两种方法都是爆破法来求解，但是爆破的概率有点小，需要爆破三位。全凭运气了，概率为4096分之一。但还是写一下。最近发现爆破法用得挺多的。
通过ret_push_after 的exp在下面
12345678910111213141516171819202122from pwn import *context.log_level = &quot;debug&quot;global pdef pwn():    ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/07/10/%E7%86%8A%E7%8C%AB%E6%9D%AF-PWN%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="熊猫杯-PWN题复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E7%99%BD%E5%A4%A9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="熊猫杯-PWN题复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/%E7%86%8A%E7%8C%AB%E6%9D%AF-PWN%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="熊猫杯-PWN题复现">熊猫杯-PWN题复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.606Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">熊猫杯-PWN题复现safestring一个格式化字符串的利用，但是不能需要先进行加密再进行传输，其实也就是一个凯撒加密，逆向出来的解密函数如下
1234567891011121314151617181920def decode_s(data):    result = bytearray()    data=bytearray(data)    for byte in data:        if 32 &lt;= byte &lt;= 126:  # 可见字符范围            if 65 &lt;= byte &lt;= 90:  # 大写字母 A-Z                base = 65            elif 97 &lt;= byte &lt;= 122:  # 小写字母 a-z                base = 97            else:                result.append(byte)                continue              # 凯撒密码解密，向前移动23个位置   ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/07/10/%E5%AE%89%E8%AF%A2%E6%9D%AF2022PWN/" title="安询杯2022PWN"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安询杯2022PWN"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/%E5%AE%89%E8%AF%A2%E6%9D%AF2022PWN/" title="安询杯2022PWN">安询杯2022PWN</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.605Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">PWNbabyarm变表base64加密，解密一下就行
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364# coding:utf-8s = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&quot;def My_base64_encode(inputs):	# 将字符串转化为2进制	bin_str = []	for i in inputs:		x = str(bin(ord(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)		bin_str.append(&#x27;&#123;:0&gt;8&#125;&#x27;.format(x))	#print(bin_str)	# 输出的字符串	outputs = &quot;&quot;	# 不够三倍数，需补齐的次数	nums ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/07/10/%E6%A0%88%E8%BF%81%E7%A7%BB%E9%9D%A2%E8%AF%95%E5%81%9A%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="栈迁移面试做题复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="栈迁移面试做题复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/%E6%A0%88%E8%BF%81%E7%A7%BB%E9%9D%A2%E8%AF%95%E5%81%9A%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="栈迁移面试做题复现">栈迁移面试做题复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.605Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">栈迁移面试做题复现前言在面试星盟安全的时候，遇到一道栈迁移的题，因为好久没做题了，花了很久的时间才做出来，现在专门写一篇博客记录一下
栈迁移栈迁移主要就是在恢复栈地址后，返回到leave继续恢复，就能够根据我们覆盖的ebp的值去将栈偏移过去，也就是可以将执行流给转移过去。最主要的利用难度就是如何控制迁移过去的地址上面的值，
一种是泄露当前ebp的值然后栈迁移到当前栈地址的前面，利用我们写进去的脏数据来ROP，
还有一种就是利用read和一些现成的其他函数去控制对应地址，这里一般就是转移到bss段去控制（bss段含有一些其他的数据，在后面执行函数的时候可能会有影响，所以我们一般选取具有写权限的高地址的地址）
题目详情
这里由于汇编较为简单，于是我就直接放的汇编。
没有开启pie保护，没有system函数，于是需要泄露libc地址

这里存在栈溢出漏洞，但只允许溢出16个字节
于是我们考虑栈迁移
但是没有其他函数泄露ebp的地址，于是我们可以利用现成的read函数，可以看到read函数的rsi是由rbp-0x60控制的，于是我们控制ebp即可，就可以控制ebp-0x60地址上的值
再在eb ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/07/10/starCTF2023-pwn%E5%A4%8D%E7%8E%B0/" title="starCTF2023-pwn复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="starCTF2023-pwn复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/starCTF2023-pwn%E5%A4%8D%E7%8E%B0/" title="starCTF2023-pwn复现">starCTF2023-pwn复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.604Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">starCTF2023-pwn复现starvmdrop</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/07/10/ISCC%E6%AF%94%E8%B5%9B%E5%A4%8D%E7%9B%98/" title="ISCC比赛复盘"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E7%99%BD%E5%A4%A9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ISCC比赛复盘"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/ISCC%E6%AF%94%E8%B5%9B%E5%A4%8D%E7%9B%98/" title="ISCC比赛复盘">ISCC比赛复盘</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.603Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">ISCC比赛复盘ISCC分为理论题和CTF题还有内网环境的AWD环境
CTF首先是CTF，因为这次CTF是将web和pwn单独摘到AWD里面去了，所以只有安卓，逆向，杂向，密码这几个方向，这让我深刻体会到了全方面发展的重要性，有时候不能只会一个方向
比如学pwn的，对于逆向也得有一定的了解，无论是WINDOWS逆向还是安卓逆向，对于学pwn的人来说，逆向的入门还是没有那么难的，起码在比赛的压力下，学了半天安卓还是有一定突破
AWD对于这次的AWD，其实我个人是比较难受的，因为off_by_one学过一点点，但是没有仔细去研究过，所以对于这个题做了很久，大概有三个多小时左右，其他大哥对于这个题出的比较快，基本上就是卡到了内网的流量转发去了，我提前有过相关的准备，导致我在这个题打出来后，不到半个小时就能实现打全网了，所以最后和大哥们进度差不多
内网流量转发socat和ncat实现socat tcp-l:888,reuseaddr,fork TCP:目标:目标端口
nc --sh-exec &quot;nc 127.0.0.1 1000&quot; -l 888 --keep-open
nc ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/07/10/NKCTF-PWN%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="NKCTF-PWN题复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NKCTF-PWN题复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/NKCTF-PWN%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="NKCTF-PWN题复现">NKCTF-PWN题复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.603Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">NKCTF-PWN题复现前言上周刚加入了星盟安全团队，发现自己真的有很多需要学习的，深感自己的渺小，这次NK也是一直跟着师傅们后面学习和搞misc，pwn一会就做完了，师傅们牛逼！
ez_shellcode这个题没什么意思，NOP滑行就行
123456def exploit():    li(&#x27;exploit...&#x27;)    code = shellcraft.sh()  # 同上    code = asm(code)        # 同上    code = &#x27;\x90&#x27;*100+code    sla(&quot;u can make it in 5 min!&quot;,code)

ez_stack以前看过一点关于SROP原理的但是没有做过这种类型的题，这也算是我的第一个SROP的题了，就是做题的经验少了，后面有个小问题没有解决，问了师傅才知道的。

想办法输入&#x2F;bin&#x2F;sh字符串然后调用syscall sigframe就行
这里通过syscall 调用read函数来控制rax的值，然后调用sig

还有就是这里直 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/07/10/GoogleCTF2023%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2023复现"><img class="post-bg" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GoogleCTF2023复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/07/10/GoogleCTF2023%E5%A4%8D%E7%8E%B0/" title="GoogleCTF2023复现">GoogleCTF2023复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2024-07-10T09:21:39.602Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/">赛题复现</a></span></div><div class="content">GoogleCTF2023复现WRITE-FLAG-WHERE题目描述
This challenge is not a classical pwn In order to solve it will take skills of your own An excellent primitive you get for free Choose an address and I will write what I see But the author is cursed or perhaps it’s just out of spite For the flag that you seek is the thing you will write ASLR isn’t the challenge so I’ll tell you what I’ll give you my mappings so that you’ll have a shot.

解题过程该程序提供了一个可以任意地址写入flag的功能，于是我们思考如何才能把flag写入到一个能输出的位置即可，当我们直接通过写/proc/sel ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/17/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/#content-inner">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/#content-inner">19</a><span class="space">&hellip;</span><a class="page-number" href="/page/37/#content-inner">37</a><a class="extend next" rel="next" href="/page/19/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/73c31ad1881611ebb6edd017c2d2eca2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">C0KE</div><div class="author-info__description">C0KE's Study Diary</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">370</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">53</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/C0KE"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/C0KE" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_62675330?spm=1000.2115.3001.5343" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:2269279877@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">人人都有选择如何活着的权力</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/10/%E7%BA%BF%E7%A8%8B%EF%BC%8C%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%8D%8F%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB/" title="线程，进程，协程的区别"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="线程，进程，协程的区别"/></a><div class="content"><a class="title" href="/2024/07/10/%E7%BA%BF%E7%A8%8B%EF%BC%8C%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%8D%8F%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB/" title="线程，进程，协程的区别">线程，进程，协程的区别</a><time datetime="2024-07-10T09:21:39.754Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/10/%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/" title="进程间的通信"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E7%99%BD%E5%A4%A9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="进程间的通信"/></a><div class="content"><a class="title" href="/2024/07/10/%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/" title="进程间的通信">进程间的通信</a><time datetime="2024-07-10T09:21:39.754Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/10/linux%E7%AE%A1%E9%81%93/" title="linux管道"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E7%99%BD%E5%A4%A9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="linux管道"/></a><div class="content"><a class="title" href="/2024/07/10/linux%E7%AE%A1%E9%81%93/" title="linux管道">linux管道</a><time datetime="2024-07-10T09:21:39.753Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/10/%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F/" title="线程间的通信方式"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="线程间的通信方式"/></a><div class="content"><a class="title" href="/2024/07/10/%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F/" title="线程间的通信方式">线程间的通信方式</a><time datetime="2024-07-10T09:21:39.753Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/10/%E9%9B%B6%E4%BF%A1%E4%BB%BB-%E6%B7%B1%E4%BF%A1%E6%9C%8D%E9%9B%B6%E4%BF%A1%E4%BB%BBaTrust%E4%BB%8B%E7%BB%8D/" title="零信任-深信服零信任aTrust介绍"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="零信任-深信服零信任aTrust介绍"/></a><div class="content"><a class="title" href="/2024/07/10/%E9%9B%B6%E4%BF%A1%E4%BB%BB-%E6%B7%B1%E4%BF%A1%E6%9C%8D%E9%9B%B6%E4%BF%A1%E4%BB%BBaTrust%E4%BB%8B%E7%BB%8D/" title="零信任-深信服零信任aTrust介绍">零信任-深信服零信任aTrust介绍</a><time datetime="2024-07-10T09:21:39.751Z" title="发表于 2024-07-10 17:21:39">2024-07-10</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/APT%E6%94%BB%E5%87%BB%E5%88%86%E6%9E%90/"><span class="card-category-list-name">APT攻击分析</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AWD%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">AWD笔记</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Blockchain%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">Blockchain笔记</span><span class="card-category-list-count">12</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CTFwiki/"><span class="card-category-list-name">CTFwiki</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CTF%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">CTF笔记</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CVE%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92/"><span class="card-category-list-name">CVE复现计划</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Crypto%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">Crypto笔记</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C%E8%AF%AD%E8%A8%80%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">C语言笔记</span><span class="card-category-list-count">15</span></a></li>
            </ul></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><span class="card-archive-list-count">370</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">370</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-07-10T09:26:02.076Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/%E9%B2%B8%E8%90%BD.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 By C0KE</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["你在抱怨什么呢","为明天到来的事，说人生像是没有意义","没有选择会是唯一的路","这不是你自己的问题，人终归要好好去生活"])
  } else {
    document.getElementById("subtitle").textContent = "你在抱怨什么呢"
  }
}
typedJSFn.run(subtitleType)</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="C0KE,LOVE,YOU" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>