<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BLECTF低功耗蓝牙CTF change | Daily Study</title><meta name="author" content="C0KE"><meta name="copyright" content="C0KE"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="BLECTF:低功耗蓝牙CTF change前言环境配置需要的设备 esp32（含有wifi和蓝牙模块的板子） CSR4.0（外接蓝牙模块）  这里需要注意的是esp32的设备需要用好一点的连接线才可以连接成功，有时候连接不成功可能是连接线的问题 https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_40589912&#x2F;article&#x2F;details&#x2F;108301290 下载ESPtools可以直接通过">
<meta property="og:type" content="article">
<meta property="og:title" content="BLECTF低功耗蓝牙CTF change">
<meta property="og:url" content="http://example.com/2024/07/22/BLECTF%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF%20change/index.html">
<meta property="og:site_name" content="Daily Study">
<meta property="og:description" content="BLECTF:低功耗蓝牙CTF change前言环境配置需要的设备 esp32（含有wifi和蓝牙模块的板子） CSR4.0（外接蓝牙模块）  这里需要注意的是esp32的设备需要用好一点的连接线才可以连接成功，有时候连接不成功可能是连接线的问题 https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_40589912&#x2F;article&#x2F;details&#x2F;108301290 下载ESPtools可以直接通过">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png">
<meta property="article:published_time" content="2024-07-22T01:35:17.483Z">
<meta property="article:modified_time" content="2024-07-22T01:35:17.484Z">
<meta property="article:author" content="C0KE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png"><link rel="shortcut icon" href="/img/fa.jpg"><link rel="canonical" href="http://example.com/2024/07/22/BLECTF%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF%20change/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BLECTF低功耗蓝牙CTF change',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-22 09:35:17'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/73c31ad1881611ebb6edd017c2d2eca2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">379</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">53</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Daily Study"><span class="site-name">Daily Study</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BLECTF低功耗蓝牙CTF change</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-22T01:35:17.483Z" title="发表于 2024-07-22 09:35:17">2024-07-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-22T01:35:17.484Z" title="更新于 2024-07-22 09:35:17">2024-07-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%93%9D%E7%89%99/">蓝牙</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BLECTF低功耗蓝牙CTF change"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="BLECTF-低功耗蓝牙CTF-change"><a href="#BLECTF-低功耗蓝牙CTF-change" class="headerlink" title="BLECTF:低功耗蓝牙CTF change"></a>BLECTF:低功耗蓝牙CTF change</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><h3 id="需要的设备"><a href="#需要的设备" class="headerlink" title="需要的设备"></a>需要的设备</h3><ul>
<li>esp32（含有wifi和蓝牙模块的板子）</li>
<li>CSR4.0（外接蓝牙模块）</li>
</ul>
<p>这里需要注意的是esp32的设备需要用好一点的连接线才可以连接成功，有时候连接不成功可能是连接线的问题</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40589912/article/details/108301290">https://blog.csdn.net/qq_40589912/article/details/108301290</a></p>
<h3 id="下载ESPtools"><a href="#下载ESPtools" class="headerlink" title="下载ESPtools"></a>下载ESPtools</h3><p>可以直接通过apt-get安装，但是可能会存在包不对的情况，之类的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install esptool</span><br></pre></td></tr></table></figure>

<p>也可以直接下载github库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/espressif/esptool</span><br></pre></td></tr></table></figure>

<h3 id="烧录BLECTF"><a href="#烧录BLECTF" class="headerlink" title="烧录BLECTF"></a>烧录BLECTF</h3><p>根据这个教程去烧录</p>
<p><a target="_blank" rel="noopener" href="https://github.com/hackgnar/ble_ctf/blob/master/docs/setup.md">https://github.com/hackgnar/ble_ctf/blob/master/docs/setup.md</a></p>
<p>首先下载blectf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/hackgnar/ble_ctf.git</span><br></pre></td></tr></table></figure>

<p>然后进入blectf目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ble_ctf</span><br></pre></td></tr></table></figure>

<p>最后直接烧录(我前面esptools下载用的是github上的)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../esptool-master/esptool.py -p /dev/ttyUSB0 -b 460800 --before default_reset --after hard_reset --chip esp32  write_flash --flash_mode dio --flash_size 2MB --flash_freq 40m 0x1000 build/bootloader/bootloader.bin 0x8000 build/partition_table/partition-table.bin 0x10000 build/ble_ctf.bin</span><br></pre></td></tr></table></figure>

<p>就成功烧录了</p>
<h3 id="安装hciconfig工具"><a href="#安装hciconfig工具" class="headerlink" title="安装hciconfig工具"></a>安装hciconfig工具</h3><p>我的虚拟机环境是kali</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get install bluetooth <span class="comment">#安装工具包</span></span><br><span class="line">service bluetooth restart <span class="comment">#重新启动蓝牙服务</span></span><br><span class="line">hciconfig <span class="comment">#查看蓝牙设备</span></span><br><span class="line">hciconfig hci0 up <span class="comment">#启动蓝牙设备</span></span><br><span class="line"><span class="built_in">sudo</span> hciconfig hci0 lestates <span class="comment">#查看蓝牙状态</span></span><br></pre></td></tr></table></figure>

<h3 id="扫描设备-gatttool的用法"><a href="#扫描设备-gatttool的用法" class="headerlink" title="扫描设备&amp;&amp;gatttool的用法"></a>扫描设备&amp;&amp;gatttool的用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hcitool lescan -i hci0</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714133810878](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714133810878.png)</a></p>
<p>我们就 能得到对应挑战的mac地址</p>
<p>通过gatttool与设备交互,使用<code>gatttool -b 78:EE:4C:01:D2:FE -I </code>进入交互模式</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714133925967](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714133925967.png)</a></p>
<p>这里简单列举gatttool的几个使用方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">GATT commands</span><br><span class="line">--primary                                 发现GATT服务</span><br><span class="line">--characteristics                         发现设备上所有的characteristics</span><br><span class="line">--char-read                               读某个characteristics，需要指定一个handle（句柄）</span><br><span class="line">--char-write                              写某个characteristics，需要指定一个handle，使用Write Without Response的方式</span><br><span class="line">--char-write-req                          写某个characteristics，需要指定一个handle，使用Write Request的方式</span><br><span class="line">--char-desc                               发现所有的Characteristics Descriptor</span><br><span class="line">--listen                                  监听Characteristics的notification或者indication</span><br><span class="line"></span><br><span class="line">Primary Services/Characteristics arguments</span><br><span class="line">  -s, --start=0x0001                        起始handle</span><br><span class="line">  -e, --end=0xffff                          结束handle</span><br><span class="line">  -u, --uuid=0x1801                         16比特或者128比特的UUID</span><br><span class="line"></span><br><span class="line">Characteristics Value/Descriptor Read/Write arguments</span><br><span class="line">  -a, --handle=0x0001                       通过handle来读写characteristic，后面接handle值</span><br><span class="line">  -n, --value=0x0001                        写characteristic时候的参数，后面接具体的值</span><br><span class="line"></span><br><span class="line">Application Options:</span><br><span class="line">  -i, --adapter=hciX                        后面接设备描述， 如hci0等</span><br><span class="line">  -b, --device=MAC                          远端设备的蓝牙地址</span><br><span class="line">  -t, --addr-type=[public | random]         远端设备蓝牙地址的类型，默认为public</span><br><span class="line">  -m, --mtu=MTU                             att协议的MTU大小</span><br><span class="line">  -p, --psm=PSM                             制定gatt的PSM，默认值为0</span><br><span class="line">  -l, --sec-level=[low | medium | high]     安全等级，默认为low</span><br><span class="line">  -I, --interactive                         交互式模式</span><br></pre></td></tr></table></figure>



<p>gatttool具体的使用方法参考如下</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010764600/article/details/119685484">https://blog.csdn.net/u010764600/article/details/119685484</a></p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>如果查看状态返回</li>
</ul>
<p><code>Read LE supported states on hci0 returned status 1</code> 表示你的蓝牙适配器不支持 BLE，正常的应该是这样的</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714133053405](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714133053405.png)</a></p>
<ul>
<li>开启设备失败</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hciconfig hci0 up</span><br><span class="line">Can<span class="string">&#x27;t init device hci0: Operation not possible due to RF-kill (132)</span></span><br></pre></td></tr></table></figure>

<p>出现上面的情况运行 <code>rfkill unblock all</code> 再 <code>hciconfig hci0 up</code> 即可解决</p>
<ul>
<li>gatttools报错</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali-vm:~# gatttool -b b4:e6:2d:96:14:7F --char-read -a 0x002a</span><br><span class="line">connect: Connection refused (111)</span><br></pre></td></tr></table></figure>

<p>如果出现上述的错误,默认情况下没有打开LE。你需要运行这个来在Kali中启用它</p>
<p>运行下面的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btmgmt le on</span><br></pre></td></tr></table></figure>

<ul>
<li>扫描设备报错</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hcitool lescan</span><br><span class="line">Set scan parameters failed: Input/output error. </span><br></pre></td></tr></table></figure>

<p>出现这样的情况可能是设备有问题了，重启即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hciconfig hci0 down</span><br><span class="line">hciconfig hci0 up</span><br></pre></td></tr></table></figure>

<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="ATTR服务"><a href="#ATTR服务" class="headerlink" title="ATTR服务"></a>ATTR服务</h3><p>在安装好gatttool后，用primary进行探测其服务</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715100541241](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715100541241.png)</a></p>
<p>大致能看到如下情况，这个设备是我的小米手环设备</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">attr handle: 0x0001, end grp handle: 0x0007 uuid: 00001800-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0010, end grp handle: 0x0015 uuid: 00001801-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0030, end grp handle: 0x0040 uuid: 0000180a-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0050, end grp handle: 0x0073 uuid: 00001812-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0088, end grp handle: 0x008b uuid: 0000180f-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0100, end grp handle: 0x0120 uuid: 0000fe95-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0150, end grp handle: 0x0158 uuid: 0000fdab-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0200, end grp handle: 0x0203 uuid: 00003802-0000-1000-8000-00805f9b34fb</span><br><span class="line">attr handle: 0x0230, end grp handle: 0xffff uuid: cc353442-be58-4ea2-876e-11d8d6976366</span><br></pre></td></tr></table></figure>

<p>制造商名称字符串应该在 设备信息服务，其标准UUID为0x180A。我们在这一行的服务列表中看到它:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">attr handle: 0x0030, end grp handle: 0x0040 uuid: 0000180a-0000-1000-8000-00805f9b34fb</span><br></pre></td></tr></table></figure>

<p>该UUID的其余部分只是128位BLE基本UUID <code>0000XXXX-0000-1000-8000-00805f9b34fb</code> 。不同的制造商通常会为自己的自定义服务使用自己的自定义128位基本uuid，每个服务的 <code>XXXX</code> 不同。</p>
<p>查看UUID显示的行其余部分，我们可以看到有两个额外的字段: <code>attr handle</code> 和 <code>end grp handle</code> 。BLE句柄与UUID不同:UUID定义我们要访问的属性的属性和元数据，而句柄给出特定属性的地址。在这里，我们使用服务的UUID来发现这个特定的服务是设备信息服务;现在，为了访问与其关联的数据，我们需要使用服务的列出句柄。</p>
<p>让我们尝试访问此服务的特征。为此，在gatttool中使用 <code>characteristics</code> 命令。我们需要为该服务提供两个句柄:“attr句柄”0x0010和“end grp句柄”0x0022。(这些是该服务的开始句柄和结束句柄。)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[D0:62:2C:D1:C4:CB][LE]&gt; characteristics 0x0030 0x0040</span><br></pre></td></tr></table></figure>

<p>我们现在有了一个我们试图访问的设备信息服务的特征表:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">handle: 0x0031, char properties: 0x02, char value handle: 0x0032, uuid: 00002a29-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x0033, char properties: 0x02, char value handle: 0x0034, uuid: 00002a23-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x0035, char properties: 0x02, char value handle: 0x0036, uuid: 00002a24-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x0037, char properties: 0x02, char value handle: 0x0038, uuid: 00002a25-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x0039, char properties: 0x02, char value handle: 0x003a, uuid: 00002a26-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x003b, char properties: 0x02, char value handle: 0x003c, uuid: 00002a27-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x003d, char properties: 0x02, char value handle: 0x003e, uuid: 00002a28-0000-1000-8000-00805f9b34fb</span><br><span class="line">handle: 0x003f, char properties: 0x02, char value handle: 0x0040, uuid: 00002a2a-0000-1000-8000-00805f9b34fb</span><br></pre></td></tr></table></figure>

<p>制造商名称字符串特征有 标准UUID 0x2A29。从上面的列表中挑选出来:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">handle: 0x0031, char properties: 0x02, char value handle: 0x0032, uuid: 00002a29-0000-1000-8000-00805f9b34fb</span><br></pre></td></tr></table></figure>

<p>我们现在可以通过使用 <code>char-read-hnd</code> 命令从列出的<code>字符值句柄</code>0x0032中读取制造商名称字符串特征的值:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b D0:62:2C:D1:C4:CB --char-read -a 0x32</span><br></pre></td></tr></table></figure>

<p>还发现了一个记录更详细的博客，感兴趣的师傅可以更详细研究一下<a target="_blank" rel="noopener" href="https://epxx.co/artigos/bluetooth_gatt.html">https://epxx.co/artigos/bluetooth_gatt.html</a></p>
<h2 id="闯关"><a href="#闯关" class="headerlink" title="闯关"></a>闯关</h2><p>参考这两个师傅的笔记</p>
<p><a target="_blank" rel="noopener" href="https://github.com/camercu/ble-ctf">https://github.com/camercu/ble-ctf</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1947203">https://cloud.tencent.com/developer/article/1947203</a></p>
<h3 id="查看分数和提交flag"><a href="#查看分数和提交flag" class="headerlink" title="查看分数和提交flag"></a>查看分数和提交flag</h3><p>提交分数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b device_mac --char-read -a 0x002a|awk -F<span class="string">&#x27;:&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>|<span class="built_in">tr</span> -d <span class="string">&#x27; &#x27;</span>|xxd -r -p;<span class="built_in">printf</span> <span class="string">&#x27;\n&#x27;</span></span><br></pre></td></tr></table></figure>

<p>提交结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b de:ad:be:ef:be:f1 --char-write-req -a 0x002c -n $(<span class="built_in">echo</span> -n <span class="string">&quot;some flag value&quot;</span>|xxd -ps)</span><br></pre></td></tr></table></figure>

<h3 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h3><blockquote>
<p>Flag one is a gift! You can only obtain it by reading this document or peaking at the source code. In short, this flag is to get you familiar with doing a simple write to a BLE handle. Do the following to get your first flag. Make sure you replace the MAC address in the examples below with your devices mac address!</p>
<p>First, check out your score:</p>
<p>gatttool -b de:ad:be:ef:be:f1 –char-read -a 0x002a|awk -F’:’ ‘{print $2}’|tr -d ‘ ‘|xxd -r -p;printf ‘\n’</p>
<p>Next, lets sumbmit the following flag. gatttool -b de:ad:be:ef:be:f1 –char-write-req -a 0x002c -n $(echo -n “12345678901234567890”|xxd -ps)</p>
<p>Finaly, check out your score again to see your flag got accepted:</p>
<p>gatttool -b de:ad:be:ef:be:f1 –char-read -a 0x002a|awk -F’:’ ‘{print $2}’|tr -d ‘ ‘|xxd -r -p;printf ‘\n’</p>
</blockquote>
<p>送分题，教你怎么提交 flag 的，使用 –char-write-req 向句柄 44 提交 <code>12345678901234567890</code> 即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE  --char-write-req -a 0x002c -n $(<span class="built_in">echo</span> -n <span class="string">&quot;12345678901234567890&quot;</span>|xxd -ps)     </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714141151148](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714141151148.png)</a></p>
<p>成功</p>
<h3 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h3><blockquote>
<p>Check out the ascii value of handle 0x002e and submit it to the flag submision handle 0x002c. If you are using gatttool, make sure you convert it to hex with xxd. If you are using bleah, you can send it as a string value.</p>
</blockquote>
<p>想让我们读取0x002e句柄的值，然后传递给0x002c句柄</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-read -a 0x002e      </span><br><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x002c -n $(<span class="built_in">echo</span> -n <span class="string">&quot;d205303e099ceff44835&quot;</span> | xxd -ps )</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714142925657](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714142925657.png)</a></p>
<p>成功</p>
<h3 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h3><blockquote>
<p>Check out the ascii value of handle 0x0030. Do what it tells you and submit the flag you find to 0x002c.</p>
</blockquote>
<p>让我们检查 0x0030 这个句柄的值，看看想让我们做啥，查看后转为 ASCII 是 <strong>MD5 of Device Name</strong>，设备名称自然就是 <strong>BLECTF</strong> 了，取其 MD5 值的前 20 个字符</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714143121022](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714143121022.png)</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-read -a 0x0030</span><br><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x002c -n $(<span class="built_in">echo</span> -n <span class="string">&quot;5cd56d74049ae40f442e&quot;</span> | xxd -ps )</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714143255015](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714143255015.png)</a></p>
<h3 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h3><blockquote>
<p>Bluetooth GATT services provide some extra device attributes. Try finding the value of the Generic Access -&gt; Device Name.</p>
</blockquote>
<p>蓝牙GATT服务提供了一些额外的设备属性。尝试查找通用访问-&gt;设备名称的值。</p>
<p>“服务”是数据片段的集合(每个数据点称为“特征”)，用于完成特定功能或提供设备的特征。根据蓝牙核心规范，通用访问服务(或者更正式地说，“通用访问配置文件&#x2F;GAP服务”)是所有GATT服务器的强制性服务，它具有某些必需的特征，包括设备名称。蓝牙分配号码文档指定设备名称特征具有UUID <code>0x2A00</code> (参见前面的挑战以获得关于UUID格式的更详细解释)。</p>
<p>就是让我们找到设备名称的值,我通过手机的LightBlue找到了对应的设备名称</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714144458362](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714144458362.png)</a></p>
<p>或者读取UUID开头为<code>2A00</code>的句柄</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714211542888](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714211542888.png)</a></p>
<p>通过句柄0x16读取</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-read -a 0x0016</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714145406163](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714145406163.png)</a></p>
<h3 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h3><blockquote>
<p>Read handle 0032 and do what it says. Notice that its not telling you to write to the flag handle as you have been. When you find the flag, go ahead and write it to the flag handle you have used in the past flags.</p>
</blockquote>
<p>先读 0x0032 句柄的内容是 <strong>Write anything here</strong>，那就随便写点东西</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714145921042](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714145921042.png)</a></p>
<p>成功读取到flag，然后0x2c句柄提交flag即可</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714150116960](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714150116960.png)</a></p>
<p>成功</p>
<h3 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h3><blockquote>
<p>Follow the instructions found from reading handle 0x0034. Keep in mind that some tools only write hex values while other provide methods for writing either hex or ascii</p>
</blockquote>
<p>按照读取句柄0x0034的说明操作。请记住，有些工具只写十六进制值，而其他工具提供了写十六进制或ascii的方法。</p>
<p>按照要求写“yo”到0x0034</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714150808693](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714150808693.png)</a></p>
<p>得到flag，并提交</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714150915649](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714150915649.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714150923993](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714150923993.png)</a></p>
<p>成功</p>
<h3 id="第七关"><a href="#第七关" class="headerlink" title="第七关"></a>第七关</h3><blockquote>
<p>Follow the instructions found from reading handle 0x0036. Keep in mind that some tools only write hex values while other provide methods for writing either hex or ascii</p>
</blockquote>
<p>按照读取句柄0x0036的说明操作。请记住，有些工具只写十六进制值，而其他工具提供了写十六进制或ascii的方法</p>
<p>直接不转换，直接传递即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-read -a 0x0036 | <span class="built_in">cut</span> -d <span class="string">&quot;:&quot;</span> -f 2 | xxd -r -p </span><br><span class="line"><span class="built_in">sudo</span> gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x0036 -n 07 </span><br><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x002c -n $(<span class="built_in">echo</span> -n <span class="string">&quot;1179080b29f8da16ad66&quot;</span> | xxd -ps )</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714151510853](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714151510853.png)</a></p>
<h3 id="第八关"><a href="#第八关" class="headerlink" title="第八关"></a>第八关</h3><blockquote>
<p>Follow the instructions found from reading handle 0x0038. Pay attention to handles here. Keep in mind handles can be refrenced by integer or hex. Most tools such as gatttool and bleah allow you to specify handles both ways.</p>
</blockquote>
<p>按照读取句柄0x0038的说明操作。注意这里的句柄。请记住句柄可以被整数或十六进制引用。大多数工具(如gatttool和bleah)允许您以两种方式指定句柄。</p>
<p>直接按照要求写入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 58 -n c9 </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714152448156](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714152448156.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714152601506](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714152601506.png)</a></p>
<p>成功</p>
<p>—————————————————————–分割线</p>
<p>因为后面的实验是我吃了晚饭回来做的，设备被我关掉了直接重启了，所以后面的分数都是从0开始的了</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714201940857](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714201940857.png)</a></p>
<h3 id="第九关"><a href="#第九关" class="headerlink" title="第九关"></a>第九关</h3><blockquote>
<p>Take a look at handle 0x003c and do what it says. You should script up a solution for this one. Also keep in mind that some tools write faster than others.</p>
</blockquote>
<p>看看句柄0x003c，并按照它所说的去做。你应该为这个问题编写一个解决方案。还要记住，有些工具编写速度比其他工具快。</p>
<p>句柄0x003C为暴力破解我的值 00 到 ff</p>
<p>让我们对它进行暴力破解，直接用 python 写个循环就行了</p>
<p>python 中有一个 zfill 方法用来给字符串前面补 0，n.zfill(2) 表示 n 要是不足两个字符的话就左边补零</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    x = <span class="built_in">str</span>(<span class="built_in">hex</span>(i))[<span class="number">2</span>:]</span><br><span class="line">    x = x.zfill(<span class="number">2</span>)</span><br><span class="line">    payload = <span class="string">&quot;gatttool -b 78:EE:4C:01:D2:FE  --char-write-req -a 0x003c -n &quot;</span>+ x</span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    os.system(payload)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714202225294](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714202225294.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714202723174](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714202723174.png)</a></p>
<p>读取flag和提交flag</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714203428350](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714203428350.png)</a></p>
<p>成功</p>
<h3 id="第十关"><a href="#第十关" class="headerlink" title="第十关"></a>第十关</h3><blockquote>
<p>Talke a look at handle 0x003e and do what it says. Keep in mind that some tools have better connection speeds than other for doing reads and writes. This has to do with the functionality the tool provides or how it uses cached BT connections on the host OS. Try testing different tools for this flag. Once you find the fastest one, whip up a script or bash 1 liner to complete the task. FYI, once running, this task takes roughly 90 seconds to complete if done right.</p>
</blockquote>
<p>看一下句柄0x003e并按照它所说的去做。请记住，在进行读写操作时，有些工具的连接速度比其他工具要快。这与工具提供的功能或它如何在主机操作系统上使用缓存的BT连接有关。尝试为这个标志测试不同的工具。找到最快的方法后，编写一个脚本或bash 1命令行来完成任务。仅供参考，一旦运行，如果操作正确，这个任务大约需要90秒才能完成。</p>
<p>Read me 1000 times 读 1000 次？还是用 python 循环执行系统命令不就行了？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    payload = <span class="string">&#x27;gatttool -b 78:EE:4C:01:D2:FE --char-read -a 0x3e | cut -d &quot;:&quot; -f 2 | xxd -r -p&#x27;</span></span><br><span class="line">    time.sleep(<span class="number">0.1</span>)</span><br><span class="line">    os.system(payload)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%d--------&gt;&quot;</span>%i)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714203930229](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714203930229.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714204006691](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714204006691.png)</a></p>
<p>成功</p>
<h3 id="第十一关"><a href="#第十一关" class="headerlink" title="第十一关"></a>第十一关</h3><blockquote>
<p>Check out handle 0x0040 and google search gatt notify. Some tools like gatttool have the ability to subscribe to gatt notifications</p>
</blockquote>
<p>检查句柄0x0040然后谷歌搜索gatt notify。一些工具，如gatttool，具有订阅gatt notifications的功能</p>
<p>0x0040 这个句柄给出的提示信息是：<strong>Listen to me for a single notification</strong>，用 gatttool 监听从蓝牙发送过来通知（notification）的数据，涉及到 GATT 的通知，客户端（kali）可以向服务端（esp32）请求通知一项特征值，当该特征可用时服务端会通知客户端，通知（notification）不需要客户端回应 ACK</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x0040 -n 00 --listen </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714205213437](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714205213437.png)</a></p>
<p>提交flag</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714205201379](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714205201379.png)</a></p>
<h3 id="第十二关"><a href="#第十二关" class="headerlink" title="第十二关"></a>第十二关</h3><blockquote>
<p>Check out handle 0x0042 and google search gatt indicate. For single response indicate messages, like this challenge, tools such as gatttool will work just fine.</p>
</blockquote>
<p>检查处理0x0042和谷歌搜索gatt指示。对于单个响应指示消息，如此挑战，诸如gatttool之类的工具可以很好地工作。</p>
<p>0x0042 句柄说：<strong>Listen to handle 0x0044 for a single indication</strong>，这个会从 ESP32 发送指示给我们，与上一个的区别在于这一个需要回应 ACK</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714205521463](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714205521463.png)</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x0044 -n 00 --listen   </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714205836116](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714205836116.png)</a></p>
<h3 id="第十三关"><a href="#第十三关" class="headerlink" title="第十三关"></a>第十三关</h3><blockquote>
<p>Check out handle 0x0046 and do what it says. Keep in mind that this notification clallange requires you to recieve multiple responses in order to complete.</p>
</blockquote>
<p>检查句柄0x0046并按照它所说的去做。请记住，此通知请求需要您收到多个响应才能完成。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b 78:EE:4C:01:D2:FE --char-write-req -a 0x0046 -n 00 --listen     </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714210344515](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714210344515.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714210306626](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714210306626.png)</a></p>
<p>提交flag</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714210423421](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714210423421.png)</a></p>
<h3 id="第十四关"><a href="#第十四关" class="headerlink" title="第十四关"></a>第十四关</h3><blockquote>
<p>Check out handle 0x0042(源文件应该写错了，0x0048）) and google search gatt indicate. Keep in mind that this chalange will require you to parse multiple indicate responses in order to complete the chalange.</p>
</blockquote>
<p>检查处理0x0042(源文件应该写错了，0x0048)和谷歌搜索gatt指示。请记住，为了完成更改，此更改将要求您解析多个指示响应。</p>
<p>0x0048 说：<strong>Listen to handle 0x004a for multi indications</strong>，跟十二关一样，就是等一会就出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gatttool -b <span class="number">78</span>:EE:4C:01:D2:FE --char-write-req -a <span class="number">0x004a</span> -n <span class="number">00</span> --listen</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714210748968](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714210748968.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240714210841887](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240714210841887.png)</a></p>
<h3 id="第十五关"><a href="#第十五关" class="headerlink" title="第十五关"></a>第十五关</h3><blockquote>
<p>Check out handle 0x004c and do what it says. Much like ethernet or wifi devices, you can also change your bluetooth devices mac address.</p>
</blockquote>
<p>检查句柄0x004c并按照它所说的去做。就像以太网或wifi设备一样，您也可以更改蓝牙设备的mac地址。</p>
<p>0x004c 这个句柄说：<strong>Connect with BT MAC address 11:22:33:44:55:66</strong> 希望我们用指定的 MAC 地址去连接。</p>
<p>这里列举几个方法把</p>
<ul>
<li>HCI 命令</li>
</ul>
<p>网上找到了这一篇教程可以通过设置HCI的OGF和OCF进行修改，但是貌似和厂商的设备有关系。</p>
<p>用<code>hcitool cmd</code>向蓝牙设备发送任意 HCI 命令。我不知道有哪些命令是可行的，所以查找这些命令，我找到了这个列表：<a target="_blank" rel="noopener" href="https://www.pocketmagic.net/hci-commands-list/">HCI 命令列表</a>。我也不明白 OGF 和 OCF 对于 HCI 命令的含义，所以我查了一下，在这里找到了一个很好的<a target="_blank" rel="noopener" href="https://community.nxp.com/t5/Wireless-Connectivity-Knowledge/Custom-HCI-command/ta-p/1101555">解释</a>，它实际上直接来自蓝牙规范。</p>
<p><a target="_blank" rel="noopener" href="https://community.murata.com/s/article/Drill-down-HCI-Commands-and-Setting-BD-ADDR">https://community.murata.com/s/article/Drill-down-HCI-Commands-and-Setting-BD-ADDR</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> hcitool cmd 0x3f 0x001 0x66 0x55 0x44 0x33 0x22 0x11</span><br><span class="line">&lt; HCI Command: ogf 0x3f, ocf 0x0001, plen 6</span><br><span class="line">  66 55 44 33 22 11</span><br><span class="line">&gt; HCI Event: 0x0e plen 4</span><br><span class="line">  01 01 FC 00</span><br><span class="line">  </span><br><span class="line"><span class="comment"># read BDADDR to confirm change</span></span><br><span class="line">$ hcitool cmd 0x04 0x009</span><br><span class="line">&lt; HCI Command: ogf 0x04, ocf 0x0009, plen 0</span><br><span class="line">&gt; HCI Event: 0x0e plen 10</span><br><span class="line">  01 09 10 00 66 55 44 33 22 11</span><br><span class="line">  </span><br><span class="line"><span class="comment"># confirm change via normal method</span></span><br><span class="line">$ hcitool dev</span><br><span class="line">Devices:</span><br><span class="line">	hci0	B8:27:EB:76:11:25</span><br><span class="line"><span class="comment"># but it didn&#x27;t change?</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Try resetting hci0 to see if change reflects</span></span><br><span class="line">$ <span class="built_in">sudo</span> hciconfig hci0 down</span><br><span class="line">$ <span class="built_in">sudo</span> hciconfig hci0 up</span><br><span class="line">$ hcitool dev</span><br><span class="line">Devices:</span><br><span class="line">	hci0	11:22:33:44:55:66</span><br><span class="line"><span class="comment"># This time the change seems to be reflected properly</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># re-read handle with new client BDADDR to get flag</span></span><br><span class="line">$ gatttool -b 08:3A:F2:AA:12:AA --char-read -a 0x4c | <span class="built_in">cut</span> -d: -f2 | xxd -p -r; <span class="built_in">echo</span></span><br><span class="line">aca16920583e42bdcf5f</span><br><span class="line"></span><br><span class="line"><span class="comment"># submit flag</span></span><br><span class="line">$ gatttool -b 08:3A:F2:AA:12:AA -a 0x2c --char-write-req -n $(<span class="built_in">echo</span> -n <span class="string">&quot;aca16920583e42bdcf5f&quot;</span> | xxd -p)</span><br></pre></td></tr></table></figure>

<p>但是我测试没成功,应该是我的设备的OGF和那个师傅的不一样</p>
<ul>
<li>bdaddr 修改mac地址</li>
</ul>
<p>网上搜到可以使用 bdaddr 去修改 MAC 地址，如果 make 的时候报错了，缺少 bluetooth&#x2F;bluetooth.h 去安装依赖：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install libbluetooth-dev</span><br></pre></td></tr></table></figure>

<p>尽管这个工具说成功了，但并没有改掉，这个工具的 issue 也说 CSR 的设备有这个问题，暂时没有得到解决，另外 spooftooph 这个工具也不行，spooftooph这个工具应该是基于经典蓝牙的，而且dbaddr已经合并到里面里面去了</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![img](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;0020f5cac65a6ac1f37457525e0f896c.png)</a></p>
<p>直接提交flag</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715131453075](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715131453075.png)</a></p>
<p>成功，这里又重启了一次，所以重新开始了</p>
<h3 id="第十六关"><a href="#第十六关" class="headerlink" title="第十六关"></a>第十六关</h3><blockquote>
<p>Read handle 0x0048 and do what it says. Setting MTU can be a tricky thing. Some tools may provide mtu flags, but they dont seem to really trigger MTU negotiations on servers. Try using gatttool’s interactive mode for this task. By default, the BLECTF server is set to force an MTU size of 20. The server will listen for MTU negotiations, and look at them, but we dont really change the MTU in the code. We just trigger the flag code if you trigger an MTU event with the value specified in handle 0x0048. GLHF!</p>
</blockquote>
<p>读取句柄0x0048（源文件应该写错了，0x004e）并按照它所说的去做。设置MTU可能是一件棘手的事情。有些工具可能提供mtu标志，但它们似乎并没有真正触发服务器上的mtu协商。尝试使用gatttool的交互模式来完成此任务。缺省情况下，BLECTF服务器强制设置MTU值为20。服务器将监听MTU协商，并查看它们，但我们并没有在代码中真正改变MTU。如果你用句柄0x0048中指定的值触发MTU事件，我们只触发标志代码。GLHF !</p>
<p>句柄 0x004e 说：<strong>Set your connection MTU to 444</strong>，使用 -m 参数 指定 MTU 大小为 444，但是不起效果，使用交互模式指定</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715132021352](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715132021352.png)</a></p>
<p>提交flag</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715132056895](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715132056895.png)</a></p>
<h3 id="第十七关"><a href="#第十七关" class="headerlink" title="第十七关"></a>第十七关</h3><blockquote>
<p>Check out handle 0x0050 and do what it says. This chalange differs from other write chalanges as your tool that does the write needs to have write response ack messages implemente correctly. This flag is also tricky as the flag will come back as notification response data even though there is no “NOTIFY” property.</p>
</blockquote>
<p>检查句柄0x0050并按照它所说的去做。这种更改与其他写更改不同，因为执行写操作的工具需要正确实现写响应返回消息。这个标志也很棘手，因为即使没有“NOTIFY”属性，该标志也会作为通知响应数据返回。</p>
<p>这些说明比实际挑战更令人生畏。不确定<code>gatttool</code>这是否只是“正确实施”还是什么。但只需要写入“hello”并重新读取句柄。我不明白的是，为什么标志从读取中返回，而提示说它应该作为通知响应返回。</p>
<p>感觉和前面的写入数据没什么区别</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715132441561](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715132441561.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715133141405](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715133141405.png)</a></p>
<h3 id="第十八关"><a href="#第十八关" class="headerlink" title="第十八关"></a>第十八关</h3><blockquote>
<p>Take a look at handle 0x0052. Notice it does not have a notify property. Do a write here and listen for notifications anyways! Things are not always what they seem!</p>
</blockquote>
<p>看看句柄0x0052。注意它没有notify属性。无论如何，在这里写一篇文章并收听通知!事情并不总是表里如一!</p>
<p>直接监听就行了，说是没有消息的，但是还是可以监听到</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715132956727](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715132956727.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715133205643](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715133205643.png)</a></p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715133149981](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715133149981.png)</a></p>
<h3 id="第十九关"><a href="#第十九关" class="headerlink" title="第十九关"></a>第十九关</h3><blockquote>
<p>Check out all of the handle properties on 0x0054! Poke around with all of them and find pieces to your flag.</p>
</blockquote>
<p>查看0x0054上的所有句柄属性!把他们都搜一遍，找到你的旗子的碎片。</p>
<p>查看属性</p>
<p><a target="_blank" rel="noopener" href="https://docs.silabs.com/bluetooth/3.2/group-sl-bt-gattdb-characteristic-properties">https://docs.silabs.com/bluetooth/3.2/group-sl-bt-gattdb-characteristic-properties</a></p>
<p>属性值0x9b的二进制形式为 <code>1001 1011</code> 。查看属性标志，它似乎有EXTENDED PROPERTIES (0x80)、NOTIFY (0x10)、WRITE (0x8)和READ (0x2)。可能也RELIABLE_WRITE (0x101)?</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715133543094](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715133543094.png)</a></p>
<p>先监听然后再查看即可</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715133709823](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715133709823.png)</a></p>
<p>提交flag</p>
<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715133812776](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715133812776.png)</a></p>
<h3 id="第二十关"><a href="#第二十关" class="headerlink" title="第二十关"></a>第二十关</h3><blockquote>
<p>Figure out the authors twitter handle and do what 0x0056 tells you to do!</p>
</blockquote>
<p>找出作者的twitter句柄，并按照0x0056告诉您的去做!</p>
<p>社工，直接看作者的简介或者该项目的README即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;@hackgnar&quot;</span> | <span class="built_in">md5sum</span> | <span class="built_in">head</span> -c 20   </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20221022230518.png">![image-20240715134229707](&#x2F;picture&#x2F;BLECTF低功耗蓝牙CTF change&#x2F;image-20240715134229707.png)</a></p>
<h2 id="完结"><a href="#完结" class="headerlink" title="完结"></a>完结</h2><p>结束了BLECTF的学习，简单来说，这个挑战可以简单了解关于BLE的一些东西，但仅仅是简单了解，要获取更多知识应该去看更多博客或者文献</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">C0KE</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/07/22/BLECTF%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF%20change/">http://example.com/2024/07/22/BLECTF%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF%20change/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Daily Study</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/22/%E5%B0%8F%E7%B1%B3%E6%89%8B%E7%8E%AF%E6%B5%8B%E8%AF%95/" title="小米手环测试"><img class="cover" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">小米手环测试</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/22/ESP32%20IoT%20CTF%20%E6%B8%85%E5%8D%8E%E6%A0%A1%E8%B5%9B%E7%89%88/" title="ESP32 IoT CTF 清华校赛版"><img class="cover" src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ESP32 IoT CTF 清华校赛版</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/73c31ad1881611ebb6edd017c2d2eca2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">C0KE</div><div class="author-info__description">C0KE's Study Diary</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">379</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">53</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/C0KE"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/C0KE" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_62675330?spm=1000.2115.3001.5343" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:2269279877@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">人人都有选择如何活着的权力</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BLECTF-%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF-change"><span class="toc-number">1.</span> <span class="toc-text">BLECTF:低功耗蓝牙CTF change</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E7%9A%84%E8%AE%BE%E5%A4%87"><span class="toc-number">1.2.1.</span> <span class="toc-text">需要的设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDESPtools"><span class="toc-number">1.2.2.</span> <span class="toc-text">下载ESPtools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%83%A7%E5%BD%95BLECTF"><span class="toc-number">1.2.3.</span> <span class="toc-text">烧录BLECTF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85hciconfig%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.4.</span> <span class="toc-text">安装hciconfig工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F%E8%AE%BE%E5%A4%87-gatttool%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">1.2.5.</span> <span class="toc-text">扫描设备&amp;&amp;gatttool的用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.2.6.</span> <span class="toc-text">注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.3.</span> <span class="toc-text">前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ATTR%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.1.</span> <span class="toc-text">ATTR服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AF%E5%85%B3"><span class="toc-number">1.4.</span> <span class="toc-text">闯关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%88%86%E6%95%B0%E5%92%8C%E6%8F%90%E4%BA%A4flag"><span class="toc-number">1.4.1.</span> <span class="toc-text">查看分数和提交flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%85%B3"><span class="toc-number">1.4.2.</span> <span class="toc-text">第一关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%85%B3"><span class="toc-number">1.4.3.</span> <span class="toc-text">第二关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E5%85%B3"><span class="toc-number">1.4.4.</span> <span class="toc-text">第三关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E5%85%B3"><span class="toc-number">1.4.5.</span> <span class="toc-text">第四关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E5%85%B3"><span class="toc-number">1.4.6.</span> <span class="toc-text">第五关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E5%85%B3"><span class="toc-number">1.4.7.</span> <span class="toc-text">第六关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E5%85%B3"><span class="toc-number">1.4.8.</span> <span class="toc-text">第七关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E5%85%B3"><span class="toc-number">1.4.9.</span> <span class="toc-text">第八关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E5%85%B3"><span class="toc-number">1.4.10.</span> <span class="toc-text">第九关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E5%85%B3"><span class="toc-number">1.4.11.</span> <span class="toc-text">第十关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%80%E5%85%B3"><span class="toc-number">1.4.12.</span> <span class="toc-text">第十一关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%8C%E5%85%B3"><span class="toc-number">1.4.13.</span> <span class="toc-text">第十二关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%89%E5%85%B3"><span class="toc-number">1.4.14.</span> <span class="toc-text">第十三关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E5%9B%9B%E5%85%B3"><span class="toc-number">1.4.15.</span> <span class="toc-text">第十四关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%94%E5%85%B3"><span class="toc-number">1.4.16.</span> <span class="toc-text">第十五关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E5%85%AD%E5%85%B3"><span class="toc-number">1.4.17.</span> <span class="toc-text">第十六关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%83%E5%85%B3"><span class="toc-number">1.4.18.</span> <span class="toc-text">第十七关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E5%85%AB%E5%85%B3"><span class="toc-number">1.4.19.</span> <span class="toc-text">第十八关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B9%9D%E5%85%B3"><span class="toc-number">1.4.20.</span> <span class="toc-text">第十九关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%B3"><span class="toc-number">1.4.21.</span> <span class="toc-text">第二十关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">完结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/22/%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96/" title="固件提取"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="固件提取"/></a><div class="content"><a class="title" href="/2024/07/22/%E5%9B%BA%E4%BB%B6%E6%8F%90%E5%8F%96/" title="固件提取">固件提取</a><time datetime="2024-07-22T01:35:17.504Z" title="发表于 2024-07-22 09:35:17">2024-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/22/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91IOT%E8%93%9D%E7%89%99/" title="西湖论剑IOT蓝牙"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E7%99%BD%E5%A4%A9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="西湖论剑IOT蓝牙"/></a><div class="content"><a class="title" href="/2024/07/22/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91IOT%E8%93%9D%E7%89%99/" title="西湖论剑IOT蓝牙">西湖论剑IOT蓝牙</a><time datetime="2024-07-22T01:35:17.493Z" title="发表于 2024-07-22 09:35:17">2024-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/22/%E8%93%9D%E7%89%99%EF%BC%9AATT%E5%92%8CGATT/" title="蓝牙：ATT和GATT"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="蓝牙：ATT和GATT"/></a><div class="content"><a class="title" href="/2024/07/22/%E8%93%9D%E7%89%99%EF%BC%9AATT%E5%92%8CGATT/" title="蓝牙：ATT和GATT">蓝牙：ATT和GATT</a><time datetime="2024-07-22T01:35:17.492Z" title="发表于 2024-07-22 09:35:17">2024-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/22/%E5%B0%8F%E7%B1%B3%E6%89%8B%E7%8E%AF%E6%B5%8B%E8%AF%95/" title="小米手环测试"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/sealed%E5%A4%9C%E6%99%9A.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小米手环测试"/></a><div class="content"><a class="title" href="/2024/07/22/%E5%B0%8F%E7%B1%B3%E6%89%8B%E7%8E%AF%E6%B5%8B%E8%AF%95/" title="小米手环测试">小米手环测试</a><time datetime="2024-07-22T01:35:17.484Z" title="发表于 2024-07-22 09:35:17">2024-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/22/BLECTF%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF%20change/" title="BLECTF低功耗蓝牙CTF change"><img src="https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BLECTF低功耗蓝牙CTF change"/></a><div class="content"><a class="title" href="/2024/07/22/BLECTF%E4%BD%8E%E5%8A%9F%E8%80%97%E8%93%9D%E7%89%99CTF%20change/" title="BLECTF低功耗蓝牙CTF change">BLECTF低功耗蓝牙CTF change</a><time datetime="2024-07-22T01:35:17.483Z" title="发表于 2024-07-22 09:35:17">2024-07-22</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://picgo-c0ke.oss-cn-hangzhou.aliyuncs.com/img/Sci-Fi%20Energy%20Core.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 By C0KE</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="C0KE,LOVE,YOU" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>